# Autonomous Driving Safety Assistant
### CV 08ì¡° ì£¼í–‰ì²­ì†Œë…„ ìµœì¢…í”„ë¡œì íŠ¸ 

<br/>
<p align="center">
   <img src="https://kr.object.ncloudstorage.com/resume/boostcamp/boostcamplogo.png" />
</p>
<p align="center">
   <img src="https://kr.object.ncloudstorage.com/resume/boostcamp/boostcamplogo2.png"/>
</p>

ë³¸ ê³¼ì •ì€ NAVER Connect ì¬ë‹¨ ì£¼ê´€ìœ¼ë¡œ ì¸ê³µì§€ëŠ¥ê³¼ ë”¥ëŸ¬ë‹ Productionì˜ End-to-Endë¥¼ ëª…í™•íˆ í•™ìŠµí•˜ê³  ì‹¤ë¬´ì—ì„œ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ í›ˆë ¨í•˜ëŠ” ì•½ 5ê°œì›”ê°„ì˜ êµìœ¡ê³¼ì •ì…ë‹ˆë‹¤. ì „ì²´ ê³¼ì •ì€ ì´ë¡ ê³¼ì •(U-stage, 5ì£¼)ì™€ ì‹¤ë¬´ê¸°ë°˜ í”„ë¡œì íŠ¸(P-stage, 15ì£¼)ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ë§ˆì§€ë§‰ ììœ¨ì£¼ì œ í”„ë¡œì íŠ¸ì¸ CV-08ì¡°ì˜ ììœ¨ì£¼í–‰ê°„ ìœ„í—˜ì˜ˆì¸¡ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤.

<br/>

## ğŸš˜ ì£¼í–‰ ì²­ì†Œë…„  
### ğŸ”… Members  

ì´ì¤€í˜|ìœ¤ì„œì—°|ê¹€ ì¤€|ì´ì¬í™
:-:|:-:|:-:|:-:
![image6](https://user-images.githubusercontent.com/85532197/172898225-6b095eff-3b1d-4930-b42b-876b29214659.png) | ![image12](https://user-images.githubusercontent.com/85532197/172898232-d1405656-3b21-4f61-83e2-394d79c151e8.png) | ![image8](https://user-images.githubusercontent.com/85532197/172898238-ae6e984a-6927-4046-9430-f89bcf775cc1.png) | ![image10](https://user-images.githubusercontent.com/85532197/172898234-878b5509-66bd-4bf2-a28d-45da58635bfb.png)
[Github](https://github.com/zzundi) | [Github](https://github.com/minakusi) | [Github](https://github.com/j8n17) | [Github](https://github.com/haymrpig) 
dlwnsgur0803@gmail.com | seoyeon737@gmail.com | j3837301@gmail.com | nevermail_@naver.com

### ğŸ”… Contribution  
- `ì´ì¤€í˜` - 3D Detection, Lane Projection  
- `ìœ¤ì„œì—°` - Forecasting, Product Serving  
- `ê¹€ ì¤€` - 2D Detection, Segmentation, Product Serving
- `ì´ì¬í™` - 3D Detection, 3D Tracking, Model Concatenation

<br/>

### âš™ Development Environment

- í˜‘ì—… íˆ´ : GitHub, WandB, Notion
	- í˜‘ì—…ì„ ìœ„í•´ ë…¸ì…˜ ì¹¸ë°˜ë³´ë“œ ì ê·¹í™œìš© (https://pinto-throne-474.notion.site/186f4c294fd44320a8270aa2c7ddd96c)
- ê°œë°œ í™˜ê²½
  - OS : Ubuntu 18.04
  - GPU : V100
  - ì–¸ì–´ : Python 3.7
  - dependency : Pytorch 1.7.1

# Project Outline  
## í”„ë¡œì íŠ¸ ì£¼ì œ

ì¹´ë©”ë¼ë¥¼ ì´ìš©í•œ ììœ¨ì£¼í–‰ì„ ìƒí’ˆí™”í•œ í…ŒìŠ¬ë¼ì˜ ë“±ì¥ìœ¼ë¡œ ììœ¨ì£¼í–‰ ì‹œì¥ì€ ë”ìš± í™œì„±í™”ê°€ ë˜ì–´ ê°€ê³  ìˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ, ì¹´ë©”ë¼ê°€ ë‹´ì„ ìˆ˜ ìˆëŠ” ì •ë³´ì—ëŠ” í•œê³„ê°€ ì¡´ì¬í•˜ì—¬, ììœ¨ì£¼í–‰ ì¤‘ì¸ í…ŒìŠ¬ë¼ ì°¨ëŸ‰ì´ í° íŠ¸ë ˆì¼ëŸ¬ ì°¨ëŸ‰ì„ ë“¤ì´ ë°•ëŠ” ì‚¬ê³ ê°€ ì¢…ì¢… ì¼ì–´ë‚¬ìŠµë‹ˆë‹¤.
ê°ì²´ì˜ ìœ„ì¹˜ì •ë³´ë¥¼ ë³´ë‹¤ ì •í™•í•˜ê²Œ ì•Œ ìˆ˜ ìˆëŠ” ë¼ì´ë‹¤ë¥¼ ì´ìš©í•˜ì—¬ ì¹´ë©”ë¼ ì •ë³´ì™€ ìœµí•©í•˜ì—¬
ì‚¬ìš©í•œë‹¤ë©´, ë³´ë‹¤ ì•ˆì „í•œ ììœ¨ì£¼í–‰ì´ ê°€ëŠ¥í•  ê²ƒì…ë‹ˆë‹¤.

ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë¼ì´ë‹¤ ë°ì´í„°ì™€ ì¹´ë©”ë¼ ë°ì´í„°ë¥¼ í•¨ê»˜ ì´ìš©í•˜ì—¬ ê°ì²´ ì¶”ì •, ì´ë™ ì˜ˆì¸¡ì„ í†µí•˜ì—¬ ì£¼í–‰ ì°¨ëŸ‰ ì•ìœ¼ë¡œ ë³´í–‰ìë‚˜ ì°¨ëŸ‰ì´ ë¼ì–´ë“œëŠ” ê²ƒì„ ê²½ê³ í•˜ì—¬ ë³´ë‹¤ ì•ˆì „í•œ ììœ¨ì£¼í–‰ì„ ìœ„í•œ ì„œë¹„ìŠ¤ë¥¼ ì œì‘í•˜ì˜€ìŠµë‹ˆë‹¤.

## ê¸°ëŒ€ íš¨ê³¼
<img src='https://user-images.githubusercontent.com/85532197/173238024-e62e2925-226c-4576-9926-602ba74109dd.png' width=50%><img src='https://user-images.githubusercontent.com/85532197/173237976-7436d213-2bc7-4a6e-8f27-aa5470e70200.png' width=50%>

ì‚¬ëŒì˜ ëˆˆìœ¼ë¡œëŠ” ëª¨ë“  ìƒí™©ì— ëŒ€í•´ì„œ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë§Œì•½ ë”¥ëŸ¬ë‹ì„ í†µí•´ ì‚¬ëŒì„ ë³´ì¡°í•  ìˆ˜ ìˆë‹¤ë©´ ì‚¬ê³ ì˜ ìœ„í—˜ì„±ì€ í¬ê²Œ ì¤„ì–´ë“¤ ê²ƒì…ë‹ˆë‹¤. 

ë¼ì´ë‹¤, ì¹´ë©”ë¼ ë°ì´í„°ë¥¼ í†µí•´ì„œ detection, tracking, forecastingì„ í†µí•´ ìœ„í—˜í•œ ìƒí™©ì„ ì˜ˆì¸¡í•˜ê³  ì‚¬ìš©ìì—ê²Œ ê²½ê³ í•´ì¤Œìœ¼ë¡œì¨ ì‚¬ê³ ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

ë˜í•œ ë” ë‚˜ì•„ê°€ì„œ ë¹„ë‹¨ ê²½ê³  ë¿ ì•„ë‹ˆë¼ ì‹¤ì œ ì°¨ëŸ‰ ì œì–´ë¥¼ í†µí•´ ììœ¨ì£¼í–‰ level 4ê¹Œì§€ ë‚˜ì•„ê°ˆ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.

## Dataset
- **KITTI Dataset**
    - **LIDAR**
        
        3D point cloud ë°ì´í„°
        
        > 3D detectionì„ ìœ„í•œ ì„¸ê°œì˜ í´ë˜ìŠ¤ (`Pedestrian`, `Car`, `Cyclist`)
        > 
    - **CAMERA**
        
        2D image ë°ì´í„°
        
        > 2D detectionì„ ìœ„í•œ ë°ì´í„°
        > 
    - **GPS / IMU**
        
        GPSì™€ IMU ì •ë³´
        
        > ego ì°¨ëŸ‰ì˜ ì´ë™ëŸ‰ì„ íŒŒì•…í•˜ê¸° ìœ„í•œ GPSì™€ IMU ë°ì´í„°
- **BDD Dataset**
    - **CAMERA**
        
        2D image ë°ì´í„°
        
        > 2D ì°¨ì„  ë° ì£¼í–‰ê°€ëŠ¥ì˜ì—­ Segmentation ë°ì´í„°
        >
## Model Structure
![Image](https://user-images.githubusercontent.com/85532197/173237401-fde65883-2410-4883-beb2-ee03e0df59f8.png)
- 2D - YOLOP (Detection - YOLOv5, Segmentation - Seg head 2ê°œ ì¶”ê°€)
- 3D - Pointpillars
- Tracking - Sort
- Forecasting - PECNet

## Demo Page Structure
![Image](https://user-images.githubusercontent.com/85532197/173237405-07fcaf37-7356-4d1d-b636-6ee4851f45ad.png)
- Frontend - Streamlit
- ackend - FastAPI
- Storage - Google Cloud Storage

# Demo
![FUSION_result_A](https://user-images.githubusercontent.com/85532197/173238845-7198f4c7-1d8b-4f21-8906-89ce3f896396.gif)


<br/>

# Project Structure


```
â”œâ”€â”€ ğŸ“‚Â serving
â”‚   â”œâ”€â”€ ğŸ“‚Â app
â”‚   â”‚   â”œâ”€â”€ ğŸ“Â __main__.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“Â frontend.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“Â main.py
â”‚   â”‚   â””â”€â”€ ğŸ“Â model.py
â”‚   â”œâ”€â”€ ğŸ“‚Â data
â”‚   â”‚   â””â”€â”€ ğŸ“Â pth files
â”‚   â”œâ”€â”€ ğŸ“‚Â deep_sort
â”‚   |	â”œâ”€â”€ ğŸ“‚Â training
â”‚   |	â””â”€â”€ ğŸ“‚ testing
â”‚   â”œâ”€â”€ ğŸ“‚Â utils
|   â””â”€â”€ ğŸ“‚Â lib_bdd
â””â”€â”€ ğŸ“‚Â YOLOP
|   â”œâ”€â”€ ğŸ“‚Â lib
|   â”œâ”€â”€ ğŸ“‚Â tools
|   |   â”œâ”€â”€ ğŸ“Â demo.py
|   |   â”œâ”€â”€ ğŸ“Â train.py
|   |   â””â”€â”€ ğŸ“Â test.py
|   â””â”€â”€ etc
â””â”€â”€ ğŸ“‚Â mmdetection3d
    â”œâ”€â”€ ğŸ“‚Â tools
    |   â”œâ”€â”€Â ğŸ“‚Â custom_tools
    |   |   â””â”€â”€ ğŸ“Â make_videos.ipynb
    |   â”œâ”€â”€Â ğŸ“‚Â utils
    |   |   â””â”€â”€ ğŸ“Â utils.py
    |   â”œâ”€â”€Â ğŸ“Â train.py
    |   â””â”€â”€Â ğŸ“Â test.py
    â””â”€â”€ etc
```
- í”„ë¡œì íŠ¸ êµ¬ì¡°
    - Serving - Streamlit-FastAPIë¡œ ìƒì„±í•œ ë°ëª¨ ì‚¬ì´íŠ¸ì— ëŒ€í•œ ì½”ë“œ ì¡´ì¬
    - YOLOP - 2D Detection ë° Semantic Segmentationì— ëŒ€í•œ ì½”ë“œ ì¡´ì¬
    - mmdetection3d - 2D Detection & Segmentation, 3D Detection, Tracking, Forecastingì„ í•©ì¹œ ì½”ë“œ ì¡´ì¬
